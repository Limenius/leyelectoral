{% extends "layout.html" %}
{% block content %}

<style type="text/css" media="screen">
body,html{
  margin:0;
  background-color: #f4f4f4;
  font-family: "Trebuchet MS";
  color: #222;
  text-align: justify;
}
#header {
  height: 49px;
  background: url('views/header.png') repeat-x;
}
#logo{
  height: 50px;
  background: url('views/logo.png') no-repeat;
}
#wrapper {
  width: 960px;
  margin: 0 auto;
}
#holder {
  float: left;
  margin: -215px 0;
  width: 960px;
  height: 1700px;
}
#floatingbuttons{
  position:fixed;
  bottom:0;
  left:0;
  width: 84px;
  background-color: red;
  border: 1px solid #000;
}
#floatinggoprev {
  border: 1px solid #000;
  width: 40px;
  height: 40px;
  float: left;
  cursor: pointer;
}
#floatinggonext {
  border: 1px solid #000;
  width: 40px;
  height: 40px;
  float: right;
  cursor: pointer;
}
#golast {
  position: absolute;
  width: 10px;
  top: 10px;
  left: 10px;
  cursor: pointer;
}
#notes {
  float: right;
  width: 475px;
  height: 270px;
  padding-right: 20px;
  margin-top: -2180px;
}
#notes2 {
  width: 430px;
  height: 210px;
  margin-top: -1930px;
}
#notes3 {
}
#reform1 {
  height: 290px;
  width: 450px;
}
#reform2 {
  height: 330px;
  width: 450px;
  padding-top: 5px;
}
#reform3 {
  height: 350px;
  width: 450px;
  padding-top: 5px;
}
#reform4 {
  height: 350px;
  width: 450px;
  padding-top: 5px;
}
.reformrules {
  width: 450px;
}
</style>
<div id="header"></div>
<div id="wrapper">
    <div id="logo"></div>
  <div id="holder">
      <div id="notes"></div>
      <div id="notes2"></div>
      <div id="notes3"></div>
      <div id="reform1"></div>
      <div id="reform2"></div>
      <div id="reform3"></div>
      <div id="reform4"></div>
      <div id="floatingbuttons">
        <div id="floatinggoprev"></div>
        <div id="floatinggonext"></div>
      </div>
  </div>
</div>

{% for key, explanation in explanations %}
<div id="shortcontent-{{key}}" class="shortcontent" style="visibility:hidden">{{ explanation | raw }}</div>
{% endfor %}

<script>
$(document).ready(function(){
    {% for provincia, results in votes %}
        DataStore.add({
            provincia : "{{provincia}}",
        });
        var prov = DataStore.detect(function(data){ return data.get('provincia') == '{{provincia}}'; });
        {% for party, result in results %}
            prov.addRow({
                label: "{{parties[party]|raw}}",
                amount: parseInt({{result}}, 10),
                oid: "{{party}}",
                color: "#{{colors[party]}}"
             });
        {% endfor %}
        prov.addRow({
           label:    "total",
           amount:    parseInt({{stats[provincia]['Censo']}}, 10),
           oid:      "total",
           statistical: true
        });
        prov.addRow({
           label:    "invalid",
           amount:    parseInt({{stats[provincia]['VNulos']}}, 10),
           oid:      "invalid",
           statistical: true
        });
        prov.addRow({
           label:    "blank",
           amount:    parseInt({{stats[provincia]['VBlanco']}}, 10),
           oid:      "blank",
           statistical: true
        });
        prov.addRow({
           label:    "nonvote",
           amount:  (parseInt({{stats[provincia]['Censo']}}, 10) - parseInt({{stats[provincia]['VCandidaturas']}}, 10)),
           oid:      "nonvote",
           statistical: true
        });
    {% endfor %}


    $('.shortcontent').each(function(index) {
        ContentStore.add({
            key: $(this).attr('id').replace("shortcontent-", ""),
            value: $(this).html()
        });
    });
    DataStore.trigger("redraw");
});

</script>
{% endblock %}
