{% extends "layout.html" %}
{% block content %}

<style type="text/css" media="screen">
body,html{
  margin:0;
  background-color: #f4f4f4;
}
#header {
  height: 59px;
  background: url('views/header.png') repeat-x;
}
#logo{
  height: 50px;
  background: url('views/logo.png') no-repeat;
}
#wrapper {
  width: 1000px;
  margin: 0 auto;
}
#holder {
  margin: -200px 0;
  width: 1000px;
  height: 700px;
}
#gonext {
  margin: -300px 0;
}
#notes {
  float: right;
  width: 500px;
  height: 300px;
  margin-right: 20px;
}
</style>
<div id="header"></div>
<div id="wrapper">
    <div id="logo"></div>
  <div id="holder">
      <div id="gonext">Next</div>
      <div id="notes">Next</div>
  </div>
</div>

{% for key, explanation in explanations %}
<div id="shortcontent-{{key}}" class="shortcontent" style="visibility:hidden">{{ explanation | raw }}</div>
{% endfor %}

<script>
$(document).ready(function(){
    {% for provincia, results in votes %}
        DataStore.add({
            provincia : "{{provincia}}",
        });
        var prov = DataStore.detect(function(data){ return data.get('provincia') == '{{provincia}}'; });
        {% for party, result in results %}
            prov.addRow({
                label: "{{parties[party]|raw}}",
                amount: parseInt({{result}}, 10),
                oid: "{{party}}",
                color: "#{{colors[party]}}"
             });
        {% endfor %}
        prov.addRow({
           label:    "total",
           amount:    parseInt({{stats[provincia]['Censo']}}, 10),
           oid:      "total",
           statistical: true
        });
        prov.addRow({
           label:    "invalid",
           amount:    parseInt({{stats[provincia]['VNulos']}}, 10),
           oid:      "invalid",
           statistical: true
        });
        prov.addRow({
           label:    "blank",
           amount:    parseInt({{stats[provincia]['VBlanco']}}, 10),
           oid:      "blank",
           statistical: true
        });
        prov.addRow({
           label:    "nonvote",
           amount:  (parseInt({{stats[provincia]['Censo']}}, 10) - parseInt({{stats[provincia]['VCandidaturas']}}, 10)),
           oid:      "nonvote",
           statistical: true
        });
    {% endfor %}


    $('.shortcontent').each(function(index) {
        ContentStore.add({
            key: "hola",
            value: $(this).text()
        });
    });
    DataStore.trigger("redraw");
});

</script>
{% endblock %}
